# Genesis RNA Large Model Configuration
# High-capacity model for state-of-the-art performance

model:
  vocab_size: 9
  d_model: 768
  n_heads: 12
  n_layers: 12
  dim_ff: 3072
  max_len: 1024
  dropout: 0.1
  attention_dropout: 0.1
  structure_num_labels: 5
  use_rotary_embeddings: false
  layer_norm_eps: 1.0e-12
  initializer_range: 0.02

training:
  # Optimization
  batch_size: 16  # Reduced for memory constraints
  learning_rate: 3.0e-5
  num_epochs: 30
  warmup_steps: 20000
  weight_decay: 0.01
  gradient_clip_norm: 1.0

  # MLM settings
  mlm_probability: 0.15

  # Multi-task loss weights
  mlm_loss_weight: 1.0
  structure_loss_weight: 0.5
  pair_loss_weight: 0.1

  # Checkpointing
  save_steps: 5000
  eval_steps: 1000
  logging_steps: 100
  output_dir: "./checkpoints/large"

  # Device and precision
  device: "cuda"
  mixed_precision: true
  fp16: true

  # Data loading
  num_workers: 8
  prefetch_factor: 2

  # AST settings
  use_ast: true
  ast_target_activation: 0.35  # Slightly lower for larger model
  ast_controller_kp: 0.01
  ast_controller_ki: 0.001

  # Reproducibility
  seed: 42
